(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var ee=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,r=[],a=0;a<t.rangeCount;a++)r.push(t.getRangeAt(a));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return t.removeAllRanges(),function(){t.type==="Caret"&&t.removeAllRanges(),t.rangeCount||r.forEach(function(n){t.addRange(n)}),e&&e.focus()}},te=ee,T={"text/plain":"Text","text/html":"Url",default:"Text"},oe="Copy to clipboard: #{key}, Enter";function ae(t){var e=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}function ne(t,e){var r,a,n,o,s,c,h=!1;e||(e={}),r=e.debug||!1;try{n=te(),o=document.createRange(),s=document.getSelection(),c=document.createElement("span"),c.textContent=t,c.ariaHidden="true",c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",function(d){if(d.stopPropagation(),e.format)if(d.preventDefault(),typeof d.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var w=T[e.format]||T.default;window.clipboardData.setData(w,t)}else d.clipboardData.clearData(),d.clipboardData.setData(e.format,t);e.onCopy&&(d.preventDefault(),e.onCopy(d.clipboardData))}),document.body.appendChild(c),o.selectNodeContents(c),s.addRange(o);var p=document.execCommand("copy");if(!p)throw new Error("copy command was unsuccessful");h=!0}catch(d){r&&console.error("unable to copy using execCommand: ",d),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),h=!0}catch(w){r&&console.error("unable to copy using clipboardData: ",w),r&&console.error("falling back to prompt"),a=ae("message"in e?e.message:oe),window.prompt(a,t)}}finally{s&&(typeof s.removeRange=="function"?s.removeRange(o):s.removeAllRanges()),c&&document.body.removeChild(c),n()}return h}var re=ne,se=function(t){return Math.floor(Math.random()*t)};function ce(t,e){var r=typeof t=="string",a;r?e!=null&&e.fix?a=Array.from(t):a=t.split(""):(e==null?void 0:e.pure)===!1?a=t:a=t.slice();for(var n=a.length;n;){var o=se(n--),s=a[o];a[o]=a[n],a[n]=s}return r?a.join(""):a}const l=document.getElementById("image"),k=document.getElementById("canvas"),y=document.getElementById("offscreen"),S=document.getElementById("file"),u=document.getElementById("shadow-image"),W=document.getElementById("precision"),P=document.getElementById("shadow-gap"),U=document.getElementById("shadow-radius"),z=document.getElementById("drop-transparent"),H=document.getElementById("drop-white"),N=document.getElementById("drop-alpha"),j=document.getElementById("text-shadow"),q=document.getElementById("shadow-text"),G=document.getElementById("shadow-text-size"),de=document.getElementById("export"),le=document.getElementById("text-shadow-style"),K=document.getElementById("anime-mode"),ie=document.getElementById("anime-shadow-style"),v=k.getContext("2d"),L=y.getContext("2d");let _,m=640,i=50,E=0,C=0,I=!0,D=!1,$=!1,f=!1,x=!1,b="@",M=1,X={};W.value=i+"";P.value=E+"";U.value=C+"";z.checked=I;H.checked=$;N.checked=D;j.checked=f;q.value=b;G.value=M+"";K.checked=x;var A;(A=document.getElementById("initial"))==null||A.addEventListener("click",()=>{S.click()});var O;(O=document.querySelector(".card-image"))==null||O.addEventListener("click",()=>{S.click()});var F;(F=document.querySelector("#import"))==null||F.addEventListener("click",()=>{S.click()});const ue=new ResizeObserver(()=>{B()});ue.observe(l);S.addEventListener("change",t=>{const e=t.target.files;!(e!=null&&e.length)||(_=e[0],document.getElementById("initial").style.display="none",document.getElementById("app").style.display="flex",B())});W.addEventListener("change",t=>{i=+t.target.value,B()});P.addEventListener("change",t=>{E=+t.target.value,g()});U.addEventListener("change",t=>{C=+t.target.value,g()});z.addEventListener("change",t=>{I=t.target.checked,g()});H.addEventListener("change",t=>{$=t.target.checked,g()});N.addEventListener("change",t=>{D=t.target.checked,g()});j.addEventListener("change",t=>{f=t.target.checked,g()});q.addEventListener("input",t=>{b=[...t.target.value.trim()][0]||b,Q()});G.addEventListener("input",t=>{M=+t.target.value,g()});K.addEventListener("change",t=>{x=t.target.checked,g()});const J=()=>{let t,e;return[new Promise((a,n)=>{t=a,e=n}),t,e]},he=t=>{const[e,r,a]=J(),n=new FileReader;return n.addEventListener("loadend",o=>{var s;(s=o.target)!=null&&s.result?r(o.target.result):a(new Error("Read file fail"))}),n.addEventListener("error",o=>{a(o)}),n.readAsDataURL(t),e},ge=(t,e)=>{const[r,a,n]=J(),o=e!=null?e:new Image;return o.src=t,o.onload=()=>{a(o)},o.onerror=s=>{n(s)},r},Q=()=>{le.innerText=`
.text-shadow::before {
    content: '${b}';
}
`},me=(t,e)=>{const r=f?"text-shadow":"box-shadow";ie.innerText=x?`
#shadow-image {
    ${r}: ${e} !important;
    will-change: auto;
    transition: box-shadow 1.2s, text-shadow 1.2s;
}
.shadow-wrap:hover #shadow-image {
    ${r}: ${t} !important;
}
`:""};Q();const B=async()=>{const t=await he(_);await ge(t,l);const e=l.naturalHeight/l.naturalWidth;y.width=i,y.height=Math.round(i*e),k.width=m=Math.min(640,l.naturalWidth,l.clientWidth),k.height=m*e,L.drawImage(l,0,0,y.width,y.height),document.querySelectorAll(".size-wrap").forEach(r=>{const a=r.style;a.width=m+"px",a.height=m*e+"px"}),v.imageSmoothingEnabled=v.mozImageSmoothingEnabled=v.webkitImageSmoothingEnabled=v.msImageSmoothingEnabled=!1,v.drawImage(y,0,0,m,m*e),g()},g=()=>{const t=l.naturalHeight/l.naturalWidth,e=m/i|0,r=Math.max(e-E,1)+"px",a=fe(e),n=x?pe(e):"none",o=e*i*t+"px",s=e*i+"px",c=C+"%";u.parentElement.style.height=o,u.parentElement.style.width=s,u.style.width=u.style.height=r,u.style.fontSize=Math.max(e-E,1)*(1+(M-1)/5)+"px",f?(u.style.textShadow=a,u.style.boxShadow="none",u.classList.add("text-shadow")):(u.style.textShadow="none",u.style.boxShadow=a,u.classList.remove("text-shadow")),u.style.borderRadius=c,me(a,n),X={blockSize:r,borderRadius:c,shadow:a,animeShadow:n,width:s,height:o}};function V(t,e,r){if(t>255||e>255||r>255)throw"Invalid color component";return(t<<16|e<<8|r).toString(16)}const fe=t=>{const e=[],r=l.naturalHeight/l.naturalWidth;for(let a=0;a<i*r;a++)for(let n=0;n<i;n++){const o=L.getImageData(n,a,1,1).data;if(I&&o[3]===0||$&&o[3]!==0&&o[0]===255&&o[1]===255&&o[2]===255)continue;const s=[...o];s.length=4;const c=D?"#"+("000000"+V(o[0],o[1],o[2])).slice(-6):`rgba(${s.map((h,p)=>p===3?+(h/255).toFixed(3):h).join(",")})`;e.push(`${c} ${n*t}px ${a*t}px`+(!f&&a===0&&n===0?` 0 ${t}px inset`:""))}return e.join(",")},pe=t=>{const e=[],r=l.naturalHeight/l.naturalWidth;let a=[];for(let o=0;o<i*r;o++)for(let s=0;s<i;s++)a.push([s,o]);a=[a[0],...ce(a.slice(1))];let n=0;for(let o=0;o<i*r;o++)for(let s=0;s<i;s++){const c=a[n++],h=c[0],p=c[1],d=L.getImageData(s,o,1,1).data;if(I&&d[3]===0||$&&d[3]!==0&&d[0]===255&&d[1]===255&&d[2]===255)continue;const w=[...d];w.length=4;const Y=D?"#"+("000000"+V(d[0],d[1],d[2])).slice(-6):`rgba(${w.map((R,Z)=>Z===3?+(R/255).toFixed(3):R).join(",")})`;e.push(`${Y} ${h*t}px ${p*t}px`+(!f&&p===0&&h===0?` 0 ${t}px inset`:""))}return e.join(",")};de.addEventListener("click",()=>{const{width:t,height:e,blockSize:r,borderRadius:a,shadow:n,animeShadow:o}=X,s=f?"text-shadow":"box-shadow",c=x?`
.wrap {
    width: ${t};
    height: ${e};
}
.pixel {
    width: ${r};
    height: ${r};
    border-radius: ${a};
    ${s}: ${o} !important;
    will-change: auto;
    transition: box-shadow 1.2s, text-shadow 1.2s;
}
.shadow-wrap:hover .pixel {
    ${s}: ${n} !important;
}
`:`
.wrap {
    width: ${t};
    height: ${e};
}
.pixel {
    width: ${r};
    height: ${r};
    border-radius: ${a};
    ${s}: ${n};
}
        `;re(c),alert("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F")});
