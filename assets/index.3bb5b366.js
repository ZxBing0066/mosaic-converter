(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();var z=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,o=[],c=0;c<t.rangeCount;c++)o.push(t.getRangeAt(c));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return t.removeAllRanges(),function(){t.type==="Caret"&&t.removeAllRanges(),t.rangeCount||o.forEach(function(n){t.addRange(n)}),e&&e.focus()}},j=z,L={"text/plain":"Text","text/html":"Url",default:"Text"},q="Copy to clipboard: #{key}, Enter";function G(t){var e=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}function K(t,e){var o,c,n,a,r,s,f=!1;e||(e={}),o=e.debug||!1;try{n=j(),a=document.createRange(),r=document.getSelection(),s=document.createElement("span"),s.textContent=t,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",function(l){if(l.stopPropagation(),e.format)if(l.preventDefault(),typeof l.clipboardData>"u"){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var E=L[e.format]||L.default;window.clipboardData.setData(E,t)}else l.clipboardData.clearData(),l.clipboardData.setData(e.format,t);e.onCopy&&(l.preventDefault(),e.onCopy(l.clipboardData))}),document.body.appendChild(s),a.selectNodeContents(s),r.addRange(a);var w=document.execCommand("copy");if(!w)throw new Error("copy command was unsuccessful");f=!0}catch(l){o&&console.error("unable to copy using execCommand: ",l),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),f=!0}catch(E){o&&console.error("unable to copy using clipboardData: ",E),o&&console.error("falling back to prompt"),c=G("message"in e?e.message:q),window.prompt(c,t)}}finally{r&&(typeof r.removeRange=="function"?r.removeRange(a):r.removeAllRanges()),s&&document.body.removeChild(s),n()}return f}var X=K;const i=document.getElementById("image"),J=document.getElementById("mosaic-image"),b=document.getElementById("canvas"),u=document.getElementById("offscreen"),x=document.getElementById("file"),p=document.getElementById("shadow-image"),M=document.getElementById("precision"),O=document.getElementById("shadow-gap"),T=document.getElementById("shadow-radius"),U=document.getElementById("drop-transparent"),$=document.getElementById("drop-white"),F=document.getElementById("drop-alpha"),Q=document.getElementById("export"),g=b.getContext("2d"),h=u.getContext("2d");let N;const I=640,y=640;let d=50,D=0,v=0,C=!0,S=!1,k=!1;M.value=d+"";O.value=D+"";T.value=v+"";U.checked=C;$.checked=k;F.checked=S;var R;(R=document.getElementById("initial"))==null||R.addEventListener("click",()=>{x.click()});var A;(A=document.querySelector(".card-image"))==null||A.addEventListener("click",()=>{x.click()});x.addEventListener("change",t=>{const e=t.target.files;!(e!=null&&e.length)||(N=e[0],document.getElementById("initial").style.display="none",document.getElementById("app").style.display="flex",W())});M.addEventListener("change",t=>{d=+t.target.value,W()});O.addEventListener("change",t=>{D=+t.target.value,m()});T.addEventListener("change",t=>{v=+t.target.value,m()});U.addEventListener("change",t=>{C=t.target.checked,m()});$.addEventListener("change",t=>{k=t.target.checked,m()});F.addEventListener("change",t=>{S=t.target.checked,m()});const P=()=>{let t,e;return[new Promise((c,n)=>{t=c,e=n}),t,e]},V=t=>{const[e,o,c]=P(),n=new FileReader;return n.addEventListener("loadend",a=>{var r;(r=a.target)!=null&&r.result?o(a.target.result):c(new Error("Read file fail"))}),n.addEventListener("error",a=>{c(a)}),n.readAsDataURL(t),e},B=(t,e)=>{const[o,c,n]=P(),a=e!=null?e:new Image;return a.src=t,a.onload=()=>{c(a)},a.onerror=r=>{n(r)},o},W=async()=>{const t=await V(N);await B(t,i);const e=i.naturalHeight/i.naturalWidth;u.width=d,u.height=d*e,b.width=y,b.height=y*e,h.imageSmoothingEnabled=h.mozImageSmoothingEnabled=h.webkitImageSmoothingEnabled=h.msImageSmoothingEnabled=!1,h.drawImage(i,0,0,u.width,u.height);const o=u.toDataURL(),c=await B(o,J);g.imageSmoothingEnabled=g.mozImageSmoothingEnabled=g.webkitImageSmoothingEnabled=g.msImageSmoothingEnabled=!1,g.drawImage(c,0,0,y,y*e),m()},m=()=>{const t=i.naturalHeight/i.naturalWidth,e=I/d|0;p.style.height=p.style.width=Math.max(e-D,1)+"px";const o=H(e);p.style.boxShadow=o||"none",p.parentElement.style.height=I*t+"px",p.style.borderRadius=v+"%"};function Y(t,e,o){if(t>255||e>255||o>255)throw"Invalid color component";return(t<<16|e<<8|o).toString(16)}const H=t=>{const e=[],o=i.naturalHeight/i.naturalWidth,c=y/d;for(let n=0;n<d*o;n++)for(let a=0;a<d;a++){const r=g.getImageData(a*c,n*c,1,1).data;if(C&&r[3]===0||k&&r[3]!==0&&r[0]===255&&r[1]===255&&r[2]===255)continue;const s=[...r];s.length=4;const f=S?"#"+("000000"+Y(r[0],r[1],r[2])).slice(-6):`rgba(${s.map((w,l)=>l===3?(w/255).toFixed(3):w).join(",")})`;e.push(`${f} ${a*t}px ${n*t}px`+(n===0&&a===0?` 0 ${t}px inset`:""))}return e.join(",")};Q.addEventListener("click",()=>{const t=I/d|0,e=H(t);X(`
.mosaic {
    box-shadow: ${e};
    width: ${t}px;
    height: ${t}px;
    border-radius: ${v}%;
}
`),alert("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F")});
