(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}})();var ee=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,r=[],o=0;o<t.rangeCount;o++)r.push(t.getRangeAt(o));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return t.removeAllRanges(),function(){t.type==="Caret"&&t.removeAllRanges(),t.rangeCount||r.forEach(function(a){t.addRange(a)}),e&&e.focus()}},te=ee,R={"text/plain":"Text","text/html":"Url",default:"Text"},ne="Copy to clipboard: #{key}, Enter";function oe(t){var e=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}function ae(t,e){var r,o,a,n,c,s,i=!1;e||(e={}),r=e.debug||!1;try{a=te(),n=document.createRange(),c=document.getSelection(),s=document.createElement("span"),s.textContent=t,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",function(l){if(l.stopPropagation(),e.format)if(l.preventDefault(),typeof l.clipboardData>"u"){r&&console.warn("unable to use e.clipboardData"),r&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var p=R[e.format]||R.default;window.clipboardData.setData(p,t)}else l.clipboardData.clearData(),l.clipboardData.setData(e.format,t);e.onCopy&&(l.preventDefault(),e.onCopy(l.clipboardData))}),document.body.appendChild(s),n.selectNodeContents(s),c.addRange(n);var f=document.execCommand("copy");if(!f)throw new Error("copy command was unsuccessful");i=!0}catch(l){r&&console.error("unable to copy using execCommand: ",l),r&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),i=!0}catch(p){r&&console.error("unable to copy using clipboardData: ",p),r&&console.error("falling back to prompt"),o=oe("message"in e?e.message:ne),window.prompt(o,t)}}finally{c&&(typeof c.removeRange=="function"?c.removeRange(n):c.removeAllRanges()),s&&document.body.removeChild(s),a()}return i}var re=ae,ce=function(t){return Math.floor(Math.random()*t)};function A(t,e){var r=typeof t=="string",o;r?e!=null&&e.fix?o=Array.from(t):o=t.split(""):(e==null?void 0:e.pure)===!1?o=t:o=t.slice();for(var a=o.length;a;){var n=ce(a--),c=o[n];o[n]=o[a],o[a]=c}return r?o.join(""):o}const d=document.getElementById("image"),k=document.getElementById("canvas"),y=document.getElementById("offscreen"),E=document.getElementById("file"),F=document.getElementById("precision"),W=document.getElementById("shadow-gap"),P=document.getElementById("shadow-radius"),U=document.getElementById("drop-transparent"),H=document.getElementById("drop-white"),N=document.getElementById("drop-alpha"),j=document.getElementById("text-shadow"),q=document.getElementById("shadow-text"),G=document.getElementById("shadow-text-size"),se=document.getElementById("export"),K=document.getElementById("anime-mode"),le=document.getElementById("pixel-style"),w=k.getContext("2d"),C=y.getContext("2d");let _,h=640,u=50,v=0,L=0,b=!0,I=!1,S=!1,m=!1,D=!1,x="@",$=1,X={};F.value=u+"";W.value=v+"";P.value=L+"";U.checked=b;H.checked=S;N.checked=I;j.checked=m;q.value=x;G.value=$+"";K.checked=D;var T;(T=document.getElementById("initial"))==null||T.addEventListener("click",()=>{E.click()});var O;(O=document.querySelector(".card-image"))==null||O.addEventListener("click",()=>{E.click()});var z;(z=document.querySelector("#import"))==null||z.addEventListener("click",()=>{E.click()});const ie=new ResizeObserver(()=>{M()});ie.observe(d);E.addEventListener("change",t=>{const e=t.target.files;!(e!=null&&e.length)||(_=e[0],document.getElementById("initial").style.display="none",document.getElementById("app").style.display="flex",M())});F.addEventListener("change",t=>{u=+t.target.value,M()});W.addEventListener("change",t=>{v=+t.target.value,g()});P.addEventListener("change",t=>{L=+t.target.value,g()});U.addEventListener("change",t=>{b=t.target.checked,g()});H.addEventListener("change",t=>{S=t.target.checked,g()});N.addEventListener("change",t=>{I=t.target.checked,g()});j.addEventListener("change",t=>{m=t.target.checked,g()});q.addEventListener("input",t=>{x=[...t.target.value.trim()][0]||x,g()});G.addEventListener("input",t=>{$=+t.target.value,g()});K.addEventListener("change",t=>{D=t.target.checked,g()});const J=()=>{let t,e;return[new Promise((o,a)=>{t=o,e=a}),t,e]},de=t=>{const[e,r,o]=J(),a=new FileReader;return a.addEventListener("loadend",n=>{var c;(c=n.target)!=null&&c.result?r(n.target.result):o(new Error("Read file fail"))}),a.addEventListener("error",n=>{o(n)}),a.readAsDataURL(t),e},ue=(t,e)=>{const[r,o,a]=J(),n=e!=null?e:new Image;return n.src=t,n.onload=()=>{o(n)},n.onerror=c=>{a(c)},r},Q=()=>{const{width:t,height:e,blockSize:r,borderRadius:o,shadow:a,animeShadow:n,fontSize:c}=X,s=m?"text-shadow":"box-shadow";let i=`
.pixel-wrap {
    width: ${t};
    height: ${e};
}
.pixel {
    width: ${r};
    height: ${r};
    border-radius: ${o};
}
`;return m&&(i+=`
.pixel::before {
    content: '${x}';
    font-size: ${c};
    font-family: initial;
    color: transparent;
}
`),D?i+=`
.pixel {
    ${s}: ${n};
    will-change: auto;
    transition: box-shadow 1.2s, text-shadow 1.2s;
}
.pixel-wrap:hover .pixel {
    ${s}: ${a};
}
`:i+=`
.pixel {
    ${s}: ${a};
}
`,i},ge=()=>{le.innerHTML=Q()},M=async()=>{const t=await de(_);await ue(t,d);const e=d.naturalHeight/d.naturalWidth;y.width=u,y.height=Math.round(u*e),k.width=h=Math.min(640,d.naturalWidth,d.clientWidth),k.height=h*e,C.drawImage(d,0,0,y.width,y.height),document.querySelectorAll(".size-wrap").forEach(r=>{const o=r.style;o.width=h+"px",o.height=h*e+"px"}),w.imageSmoothingEnabled=w.mozImageSmoothingEnabled=w.webkitImageSmoothingEnabled=w.msImageSmoothingEnabled=!1,w.drawImage(y,0,0,h,h*e),g()},g=()=>{const t=d.naturalHeight/d.naturalWidth,e=h/u|0,r=Math.max(e-v,1)+"px",o=he(e),a=D?me(e):"none",n=e*u*t+"px",c=e*u+"px",s=L+"%",i=Math.max(e-v,1)*(1+($-1)/5)+"px";X={blockSize:r,borderRadius:s,shadow:o,animeShadow:a,width:c,height:n,fontSize:i},ge()};function V(t,e,r){if(t>255||e>255||r>255)throw"Invalid color component";return(t<<16|e<<8|r).toString(16)}const he=t=>{const e=[],r=d.naturalHeight/d.naturalWidth;for(let o=0;o<u*r;o++)for(let a=0;a<u;a++){const n=C.getImageData(a,o,1,1).data;if(b&&n[3]===0||S&&n[3]!==0&&n[0]===255&&n[1]===255&&n[2]===255)continue;const c=[...n];c.length=4;const s=I?"#"+("000000"+V(n[0],n[1],n[2])).slice(-6):`rgba(${c.map((i,f)=>f===3?+(i/255).toFixed(3):i).join(",")})`;e.push(`${s} ${a*t}px ${o*t}px`+(!m&&o===0&&a===0?` 0 ${t}px inset`:""))}return e.join(",")},me=t=>{const e=[],r=d.naturalHeight/d.naturalWidth;let o=[];for(let n=0;n<u*r;n++)for(let c=0;c<u;c++)o.push([c,n]);o=m?A(o):[o[0],...A(o.slice(1))];let a=0;for(let n=0;n<u*r;n++)for(let c=0;c<u;c++){const s=o[a++],i=s[0],f=s[1],l=C.getImageData(c,n,1,1).data;if(b&&l[3]===0||S&&l[3]!==0&&l[0]===255&&l[1]===255&&l[2]===255)continue;const p=[...l];p.length=4;const Y=I?"#"+("000000"+V(l[0],l[1],l[2])).slice(-6):`rgba(${p.map((B,Z)=>Z===3?+(B/255).toFixed(3):B).join(",")})`;e.push(`${Y} ${i*t}px ${f*t}px`+(!m&&f===0&&i===0?` 0 ${t}px inset`:""))}return e.join(",")};se.addEventListener("click",()=>{const t=Q();re(t),alert("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F")});
