(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();var W=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,o=[],c=0;c<t.rangeCount;c++)o.push(t.getRangeAt(c));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return t.removeAllRanges(),function(){t.type==="Caret"&&t.removeAllRanges(),t.rangeCount||o.forEach(function(n){t.addRange(n)}),e&&e.focus()}},z=W,k={"text/plain":"Text","text/html":"Url",default:"Text"},j="Copy to clipboard: #{key}, Enter";function q(t){var e=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}function G(t,e){var o,c,n,a,r,s,h=!1;e||(e={}),o=e.debug||!1;try{n=z(),a=document.createRange(),r=document.getSelection(),s=document.createElement("span"),s.textContent=t,s.ariaHidden="true",s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",function(l){if(l.stopPropagation(),e.format)if(l.preventDefault(),typeof l.clipboardData>"u"){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var v=k[e.format]||k.default;window.clipboardData.setData(v,t)}else l.clipboardData.clearData(),l.clipboardData.setData(e.format,t);e.onCopy&&(l.preventDefault(),e.onCopy(l.clipboardData))}),document.body.appendChild(s),a.selectNodeContents(s),r.addRange(a);var w=document.execCommand("copy");if(!w)throw new Error("copy command was unsuccessful");h=!0}catch(l){o&&console.error("unable to copy using execCommand: ",l),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),h=!0}catch(v){o&&console.error("unable to copy using clipboardData: ",v),o&&console.error("falling back to prompt"),c=q("message"in e?e.message:j),window.prompt(c,t)}}finally{r&&(typeof r.removeRange=="function"?r.removeRange(a):r.removeAllRanges()),s&&document.body.removeChild(s),n()}return h}var K=G;const i=document.getElementById("image"),X=document.getElementById("mosaic-image"),b=document.getElementById("canvas"),m=document.getElementById("offscreen"),I=document.getElementById("file"),g=document.getElementById("shadow-image"),A=document.getElementById("precision"),M=document.getElementById("shadow-gap"),O=document.getElementById("shadow-radius"),T=document.getElementById("drop-transparent"),U=document.getElementById("drop-white"),$=document.getElementById("drop-alpha"),J=document.getElementById("export"),f=b.getContext("2d"),y=m.getContext("2d");let F,u=640,d=50,x=0,E=0,D=!0,C=!1,S=!1;A.value=d+"";M.value=x+"";O.value=E+"";T.checked=D;U.checked=S;$.checked=C;var B;(B=document.getElementById("initial"))==null||B.addEventListener("click",()=>{I.click()});var R;(R=document.querySelector(".card-image"))==null||R.addEventListener("click",()=>{I.click()});I.addEventListener("change",t=>{const e=t.target.files;!(e!=null&&e.length)||(F=e[0],document.getElementById("initial").style.display="none",document.getElementById("app").style.display="flex",N())});A.addEventListener("change",t=>{d=+t.target.value,N()});M.addEventListener("change",t=>{x=+t.target.value,p()});O.addEventListener("change",t=>{E=+t.target.value,p()});T.addEventListener("change",t=>{D=t.target.checked,p()});U.addEventListener("change",t=>{S=t.target.checked,p()});$.addEventListener("change",t=>{C=t.target.checked,p()});const H=()=>{let t,e;return[new Promise((c,n)=>{t=c,e=n}),t,e]},Q=t=>{const[e,o,c]=H(),n=new FileReader;return n.addEventListener("loadend",a=>{var r;(r=a.target)!=null&&r.result?o(a.target.result):c(new Error("Read file fail"))}),n.addEventListener("error",a=>{c(a)}),n.readAsDataURL(t),e},L=(t,e)=>{const[o,c,n]=H(),a=e!=null?e:new Image;return a.src=t,a.onload=()=>{c(a)},a.onerror=r=>{n(r)},o},N=async()=>{const t=await Q(F);await L(t,i);const e=i.naturalHeight/i.naturalWidth;m.width=d,m.height=d*e,b.width=u=Math.min(640,i.naturalHeight),b.height=u*e,y.imageSmoothingEnabled=y.mozImageSmoothingEnabled=y.webkitImageSmoothingEnabled=y.msImageSmoothingEnabled=!1,y.drawImage(i,0,0,m.width,m.height);const o=m.toDataURL(),c=await L(o,X);f.imageSmoothingEnabled=f.mozImageSmoothingEnabled=f.webkitImageSmoothingEnabled=f.msImageSmoothingEnabled=!1,f.drawImage(c,0,0,u,u*e),p()},p=()=>{const t=i.naturalHeight/i.naturalWidth,e=u/d|0;g.style.height=g.style.width=Math.max(e-x,1)+"px";const o=P(e);g.style.boxShadow=o||"none",g.parentElement.style.height=e*d*t+"px",g.parentElement.style.width=e*d+"px",g.style.borderRadius=E+"%"};function V(t,e,o){if(t>255||e>255||o>255)throw"Invalid color component";return(t<<16|e<<8|o).toString(16)}const P=t=>{const e=[],o=i.naturalHeight/i.naturalWidth,c=u/d;for(let n=0;n<d*o;n++)for(let a=0;a<d;a++){const r=f.getImageData(a*c,n*c,1,1).data;if(D&&r[3]===0||S&&r[3]!==0&&r[0]===255&&r[1]===255&&r[2]===255)continue;const s=[...r];s.length=4;const h=C?"#"+("000000"+V(r[0],r[1],r[2])).slice(-6):`rgba(${s.map((w,l)=>l===3?(w/255).toFixed(3):w).join(",")})`;e.push(`${h} ${a*t}px ${n*t}px`+(n===0&&a===0?` 0 ${t}px inset`:""))}return e.join(",")};J.addEventListener("click",()=>{const t=u/d|0,e=P(t);K(`
.mosaic {
    box-shadow: ${e};
    width: ${t}px;
    height: ${t}px;
    border-radius: ${E}%;
}
`),alert("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F")});
